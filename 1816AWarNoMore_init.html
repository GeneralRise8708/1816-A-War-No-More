e.CandidText = "Select your Presidential nominee:"
e.VpText = "Select your Vice Presidential nominee:"

let previousCandidate = null;

const startScreenUpdater = setInterval(function() {
    const goBackButton = document.getElementById("candidate_id_back");
    const candidateButton = document.getElementById("candidate_id_button");
    const runningMateButton = document.getElementById("running_mate_id_button");
    const finalScreenBB = document.getElementById("opponent_selection_id_back");
    const finalScreenID = document.getElementById("opponent_selection_id_button");

    const c = document.getElementById("candidate_id")?.value ?? -1;

    if (c !== previousCandidate) {
        previousCandidate = c; 

        if (c == 131) {
            if (!candidateButton) {
                goBackButton?.click();
                const initContinue = document.getElementById("election_id_button");
                initContinue?.click();
            }
        } else if (c == 132) {
            candidateButton?.remove();
        }
    }

}, 20); 

campaignTrail_temp.modBoxTheme = {
     "header_color": "#1d2e87",
     "header_text_color": "#ffffff",
     "description_text_color": "#ffffff",
     "description_background_color": "#903c3c",
     "main_color": "#872f2f",
     "secondary_color": "#2a4289",
     "ui_text_color": "#FFFFFF"
}

campaignTrail_temp.achievements = {
    "Grilled Clinton" : {
        "image" : "https://i.imgur.com/l6h23w3.png",
        "description" : "It seems Clinton/Clinton was not a winning ticket..."
    },
    "A Common Enemy" : {
        "image" : "https://i.imgur.com/hiI1Zy5.png",
        "description" : "Speak against the United Kingdom and still win."
    },
  "DeWinn Clinton" : {
        "image" : "https://i.imgur.com/yufrlwE.png",
        "description" : "As Clinton, win over 150 electoral votes",
        "cannotBeCheated" : true
     },
"A Truce To Remember" : {
        "image" : "https://i.imgur.com/PAh172R.jpeg",
        "description" : "As Clinton, sign a peace treaty with Britain before December of 1813.",
        "cannotBeCheated" : true
     },
"I Love War" : {
        "image" : "https://i.imgur.com/yR1iqMs.jpeg",
        "description" : "As Clinton, continue the war going into 1816.",
        "cannotBeCheated" : true
     },
"Making Enemies, Frenemies" : {
        "image" : "https://i.imgur.com/l3a44dt.png",
        "description" : "Get Thomas Jefferson's and John Adams's endorsements."
     },
"Praising The Predecessor?" : {
        "image" : "https://i.imgur.com/GfKVOxM.png",
        "description" : "Praise Madison's Presidency and still win."
     },
    "Green Mountain Boy" : {
        "image" : "https://i.imgur.com/lxmlTES.png",
        "description" : "Call for the abolition of slavery, and still win.",
        "cannotBeCheated" : true
    }
}

campaignTrail_temp.global_parameter_json = [
    {
        "model": "campaign_trail.global_parameter",
        "pk": 1,
        "fields": {
            "vote_variable": 1.125,
            "max_swing": 0.12,
            "start_point": 0.94,
            "candidate_issue_weight": 10,
            "running_mate_issue_weight": 3,
            "issue_stance_1_max": -0.71,
            "issue_stance_2_max": -0.3,
            "issue_stance_3_max": -0.125,
            "issue_stance_4_max": 0.125,
            "issue_stance_5_max": 0.3,
            "issue_stance_6_max": 0.71,
            "global_variance": 0.01,
            "state_variance": 0.005,
            "question_count": 30,
            "default_map_color_hex": "#C9C9C9",
            "no_state_map_color_hex": "#999999"
        }
    }
]

campaignTrail_temp.election_json = [
    {
        "model": "campaign_trail.election",
        "pk": 13,
        "fields": {
            "year": 1816,
            "display_year": "An End To War",
            "summary": "<p>After a narrow race in 1812, DeWitt Clinton stunned the nation by narrowly defeating President Madison, destroying the Virginia Dynasty that had lasted years. When Clinton took office, he was left with the responsibility of ending the War of 1812. One of his main campaign promises, peace with Britain, was a priority. In June, Clinton visited Great Britain for a peace settlement. He was able to negotiate a peace deal with Robert Jenkinson, 2nd Earl of Liverpool and on August 8th, 1813, a peace deal was signed, and the War of 1812 was over. However, Clinton remains unpopular in much of the country, and the former Sec. State, James Monroe, is running to oppose him.<br><br><button onclick='next0()'>More</button></p>",
            "image_url": "https://i.imgur.com/STBE683.png",
            "winning_electoral_vote_number": 112,
            "advisor_url": "https://i.imgur.com/AHeVWbF.png",
            "recommended_reading": "<ul>\n<li><a href=https://www.chicagotribune.com/opinion/editorials/ct-edit-chicago-tribune-biden-endorsement-20200925-lnyxsb5qvrftnjjmj3rnzj33jy-story.html>Our Case For Joe Biden</a></li>\n<li><a href=https://nationalinterest.org/feature/case-trump-166808>The Case For Trump</a></li>\n<li><a href=https://www.npr.org/2020/11/18/935730100/how-biden-won-ramping-up-the-base-and-expanding-margins-in-the-suburbs>How Biden Won: Ramping Up The Base And Expanding Margins In The Suburbs</a></li>\n<li><a href=https://www.prospectmagazine.co.uk/politics/donald-trump-joe-biden-us-election-almost-win-votes-concede>Why Did Trump Almost Win?</a></li>\n<li><a href=https://www.hoover.org/research/no-evidence-voter-fraud-guide-statistical-claims-about-2020-election>No Evidence For Voter Fraud: A Guide To Statistical Claims About The 2020 Election</a></li>\n</ul>",
            "has_visits": 0,
            "site_image": "https://i.imgur.com/sPe2htt.png",
            "site_description": "<p>After a narrow race in 1812, DeWitt Clinton stunned the nation by narrowly defeating President Madison, destroying the Virginia Dynasty that had lasted years. When Clinton took office, he was left with the responsibility of ending the War of 1812. One of his main campaign promises, peace with Britain, was a priority. In June, Clinton visited Great Britain for a peace settlement. He was able to negotiate a peace deal with Robert Jenkinson, 2nd Earl of Liverpool and on August 8th, 1813, a peace deal was signed, and the War of 1812 was over. However, Clinton remains unpopular in much of the country, and the former Sec. State, James Monroe, is running to oppose him.<br><ul><li>DeWitt Clinton must defend his wartime record and emphasize his foreign policy victories, all while fending off the Southern wing of the party. If he is to succeed, he must build a winning coalition in both New England and the Mid-Atlantic.</li><li>James Monroe hopes to reaffirm the power of Virginian interests, and starts the election with a lead. To hold on for the win, he could either attack Clinton’s unpopular peace deal, or highlight Clinton’s ties to the dying and increasingly disliked Federalist Party.</li></ul></p>",
            "no_electoral_majority_image": "../static/images/2012-no-majority.jpg"
        }
    }
]

campaignTrail_temp.temp_election_list = [
    {
        "id": 13,
        "year": 2016,
        "is_premium": 0,
        "display_year": "An End To War"
    }
]

campaignTrail_temp.credits = "<button onclick='credits()'>The End To War Team</button>";

  credits = function() {
    c = ["This mod was created by GeneralRise, TheMcCain, ListMan, and littleamericanman_85501.\n", "More specifically:", "This mod was made by General_Rise8708 and TheMcCain, with General_Rise doing most writing and TheMcCain doing most coding, and with Listman helping with some code and giving advice.\n", "Banner was made by littleamericanman_85501.\n", "Huge thanks to 1836 Davy Crockett for the map!\n", "Upgraded Soundtrack system was made by the creators of 2021 Germany, original by DecstarG.\n", "Thanks to everyone who playtested.\n", "And thanks for playing! We hope you enjoy!"]
    text = "CREDITS:\n\n"
    for (i in c) {
        text += c[i] + "\n"
    }
    alert(text)
  }

next0 = function() {
    text = '<ul style="padding-left:0; list-style-position:inside;"><li>DeWitt Clinton must defend his wartime record and emphasize his foreign policy victories, all while fending off the Southern wing of the party. If he is to succeed, he must build a winning coalition in both New England and the Mid-Atlantic.</li><li>James Monroe hopes to reaffirm the power of Virginian interests, and starts the election with a lead. To hold on for the win, he could either attack Clinton’s unpopular peace deal, or highlight Clinton’s ties to the dying and increasingly disliked Federalist Party.</li></ul><button onclick="back0()">Back</button>';
    document.getElementById("election_summary").innerHTML = text
}
back0 = function() {
    text = "<p>After a narrow race in 1812, DeWitt Clinton stunned the nation by narrowly defeating President Madison, destroying the Virginia Dynasty that had lasted years. When Clinton took office, he was left with the responsibility of ending the War of 1812. One of his main campaign promises, peace with Britain, was a priority. In June, Clinton visited Great Britain for a peace settlement. He was able to negotiate a peace deal with Robert Jenkinson, 2nd Earl of Liverpool and on August 8th, 1813, a peace deal was signed, and the War of 1812 was over. However, Clinton remains unpopular in much of the country, and the former Sec. State, James Monroe, is running to oppose him.<br><br><button onclick='next0()'>More</button></p>"
    document.getElementById("election_summary").innerHTML = text
}

campaignTrail_temp.candidate_json = [
    {
        "model": "campaign_trail.candidate",
        "pk": 131,
        "fields": {
            "first_name": "DeWitt",
            "last_name": "Clinton",
            "election": 13,
            "party": "Democratic Republican (Northern Wing)",
            "state": "New York",
            "priority": 1,
            "description": "<p>DeWitt Clinton shouldn’t be here right now. After a highly contested election in 1812, DeWitt Clinton was able to narrowly carry Pennsylvania, and with it, the Presidency, even as he lost the popular vote to James Madison.<br><br>His peace deal with the United Kingdom was widely despised outside the Northeast, and Clinton was forced to fight allegations of him being unpatriotic. The country remains in large debt after the war, and with crop prices collapsing, the economy continues to downturn. Clinton remains popular in New England, but in most of the country, his approval ratings are in the gutter. In order to have any hope of winning, he must win both the Mid-Atlantic and Midwest. To do this, he could emphasize his support for tariffs and internal improvements, or find a way to take the attack to Monroe.",
            "color_hex": "#d66f43",
            "secondary_color_hex": null,
            "is_active": 1,
            "image_url": "https://i.imgur.com/qPeWWbY.png",
            "electoral_victory_message": "<p>Well, Mr. Clinton, you did it! Since you won re-election, you can now make sure you keep a good relationship with Great Britain. Let's hope you will keep voters pleased during your second term. Good luck, Mr. Clinton.</p>",
            "electoral_loss_message": "<p>Mr. Clinton, despite you having a successful first term, it wasn't enough for voters. James Monroe won to become the Sixth President of the United States. As for you? Your legacy will definitely be one for the history books. You stopped the War of 1812 with a peace deal and a solid relationship with Great Britain. Word has it that James Monroe will cut trade with Great Britain once again. If that happens, then everything you worked for will be for nothing. But then again, it all might be a hoax. But you might be able to give it another shot at the presidency in 1820 or run to become a senator or governor of your home state of New York, or you may retire. Whatever you choose, I wish you the best, Mr. Clinton.</p> ",
            "no_electoral_majority_message": "<p>How did this happen? This is impossible? Well, unfortunately for you and Monroe, the House and Senate are controlled by the Democratic-Republicans, so it will be complicated to tell who will get elected. But will it be you? Only time will tell. Good luck, Mr. Clinton!",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 437,
        "fields": {
            "first_name": "Jared",
            "last_name": "Ingersoll",
            "election": 13,
            "party": "Federalist",
            "state": "Pennsylvania ",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#d66f43",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/Cz1Ud6e.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "<p>Jared Ingersoll Jr has been vice president since 1813. He previously served as Attorney General of Pennsylvania. Before that, he was a Founding Father and served in the Continental Congress and the Philadelphia Convention. He is a very popular figure and is approved as Vice President by voters. So keeping him on the ticket is a good idea.</p>",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 132,
        "fields": {
            "first_name": "James",
            "last_name": "Monroe",
            "election": 13,
            "party": "Democratic Republican (Southern Wing)",
            "state": "Virginia",
            "priority": 1,
            "description": "<b><em>Here for Context. Hopefully coming in the future.</em></b><p>After the defeat of James Madison in 1812, the Virginia Dynasty had collapsed, and the southern Democratic-Republicans were in disarray. James Monroe, the former Secretary of State under Madison, quickly became their preferred choice. Despite being only 58 years old, he has accumulated a large amount of experience, serving as a Virginia Senator, Virginia Governor, Ambassador to the United Kingdom and France, and as Secretary of State. With a wing that is eager to win back the Executive Mansion from Clinton, and a vulnerable opponent, many wonder if Clinton even stands a chance. All Monroe has to do is continue hammering at Clinton, and making sure that he doesn't pull off another upset.</p>",
            "color_hex": "#0cb800",
            "secondary_color_hex": null,
            "is_active": 1,
            "image_url": "https://i.imgur.com/YCgtg54.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": null,
            "candidate_score": 1,
            "running_mate": false
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 438,
        "fields": {
            "first_name": "John",
            "last_name": "E. Howard",
            "election": 13,
            "party": "Federalist",
            "state": "Maryland",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#d66f43",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://i.imgur.com/6P5FO3S.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "<p>James E. Howard is a former Governor and Senator from Maryland. He famously served only 7 days as President pro tempore of the U.S. Senate from November 21st, 1800, to November 27th, 1800. Howard will help in the state of Maryland, which you won by a hair in 1812. However, some voters prefer you keep Ingersoll instead of dropping him from the ticket. </p>",
            "candidate_score": 1,
            "running_mate": true
        }
    },
    {
        "model": "campaign_trail.candidate",
        "pk": 440,
        "fields": {
            "first_name": "Daniel",
            "last_name": "D. Tompkins",
            "election": 13,
            "party": "Democratic Republican",
            "state": "New York",
            "priority": 1,
            "description": "<p>Put description here</p>",
            "color_hex": "#0cb800",
            "secondary_color_hex": null,
            "is_active": 0,
            "image_url": "https://www.jetsimon.com/public/candidateexample.png",
            "electoral_victory_message": "This guy wins!",
            "electoral_loss_message": "This guy loses!",
            "no_electoral_majority_message": "We all win?",
            "description_as_running_mate": "<p>Not viewable. If you managed to see this, either you're looking at the source code or our code broke. Thanks for playing, while you're here.</p>",
            "candidate_score": 1,
            "running_mate": true
        }
    }
]

campaignTrail_temp.running_mate_json = [
    {
        "model": "campaign_trail.running_mate",
        "pk": 127089,
        "fields": {
            "candidate": 131,
            "running_mate": 437
        }
    },
    {
        "model": "campaign_trail.running_mate",
        "pk": 117469,
        "fields": {
            "candidate": 131,
            "running_mate": 438
        }
    },
    {
        "model": "campaign_trail.running_mate",
        "pk": 176882,
        "fields": {
            "candidate": 132,
            "running_mate": 440
        }
    }
]

campaignTrail_temp.opponents_default_json = [
    {
        "election": 13,
        "candidates": [
            131,
            132
        ]
    }
]

campaignTrail_temp.opponents_weighted_json = [
    {
        "election": 13,
        "candidates": [
            131,
            132
        ]
    }
]

jet_data = {
    "headerColor": "#8d6520",
    "windowColor": "#004f80",
    "containerColor": "#0085c7",
    "innerWindowColor": "#856800",
    "bannerImageUrl": "https://i.imgur.com/71dGYmI.png",
    "backgroundImageUrl": "https://i.imgur.com/hFxTLt5.png",
    "endingTextColor": "#000000",
    "customQuote": "\"Pleasure is a shadow, wealth is vanity, and power a pageant; but knowledge is ecstatic in enjoyment, perennial in frame, unlimited in space and indefinite in duration.\" - DeWitt Clinton",
    "gameTitle": "End to War"
}

//#startcode
$("#game_window")[0].style.background = "linear-gradient(to bottom, #3e2c1a, #b08d57)";

$(".container")[0].style.background = "linear-gradient(to bottom, #cbb994, #a0815a)";

document.getElementById("header").src = "https://i.imgur.com/ly60Au8.png";

let style = document.createElement('style');
style.type = 'text/css';
style.id = 'dynamic-style';

style.innerHTML = `
  .campaign_trail_start_emphasis {
    background-color: #8D7351;
  }

 /* Header and text colors */
  #final_results_description h3,
  #overall_details_container h3,
  #overall_election_details h4,
  #main_content_area_reading h3.results_tab_header,
  .inner_window_w_desc h3 {
    color: white;
  }

#election_image img {
  border: 2px solid #886F4D; 
  border-radius: 0;          
}
  #overall_result_container {
    background: linear-gradient(135deg, #a08350, #98794a, #7f6438) !important;
  }
  .overlay_window {
    height: auto;
  }
  a:-webkit-any-link {
    color: #7a5f3b;
    text-decoration: none;
    transition: color 0.2s ease;
  }

  a:-webkit-any-link:hover {
    color: #8f7048;
  }

  .overlay_window h3 {
    background-color: #8D7351;
    color: white;
  }

  #menu_container {
    background: linear-gradient(135deg, #a08350, #98794a, #7f6438) !important;
  }

  #state_result h3,
  #overall_result h3,
  #state_info h3 {
    background: linear-gradient(135deg, #a08350, #98794a, #7f6438);
    color: #ffffff;
    border-radius: 3px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    transition: background 0.25s ease;
  }
  .inner_window_question h3 {
    background: linear-gradient(to bottom, #a78f5c, #927649);
    color: #ffffff;
    border-radius: 1px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    transition: background 0.25s ease;
  }

  #map_container {
    background: linear-gradient(135deg, #f5efe6, #f0e6d6) !important;
    background-size: 150% 150%;
    border-radius: 0.75px;
    color: #5a3e2b;
  }

  #main_content_area_reading p,
  #final_results_description p,
  div#site_credits p,
  div#site_credits a,
  .visit_text,
  p#credits {
    color: white !important;
  }
`;

document.head.appendChild(style);


e.music = {};
e.music.shuffleEnabled = false;
e.music.Volume=1;
e.music.loopEnabled = false;

var element = document.getElementById('my-invisible-element');
if (!element) {

	// Get the reference to the bar
	var bar = document.getElementById('bottomBar');

	// Create the checkbox
	var checkbox = document.createElement('input');
	checkbox.type = 'checkbox';
	checkbox.id = 'volumeCheckbox';
	checkbox.checked = false;
	checkbox.style.display = 'none';

	// Create the label for the checkbox
	var label = document.createElement('label');
	label.htmlFor = 'volumeCheckbox';
	label.style.fontSize = '0px';  // Increase the size of the text
	label.style.fontWeight = 'bold';  // Make the text bold
	label.appendChild(document.createTextNode('Enable Volume'));

	// Wrap the checkbox and label in a div and style it
	var wrapper = document.createElement('div');
	wrapper.style.padding = '0px';  // Add some padding
	wrapper.style.borderRadius = '0px';  // Round the corners
	wrapper.style.backgroundColor = '#d3d3d3';  // Set the background color to the default button color
	wrapper.style.border = '0px solid black';  // Add a black border
	wrapper.appendChild(checkbox);
	wrapper.appendChild(label);

	// Position the wrapper in the middle of the bar
	var div = document.createElement('div');
	div.style.position = 'absolute';
	div.style.left = '50%';
	div.style.transform = 'translate(-50%, 0)';  // Center the div
	div.appendChild(wrapper);

	// Add the div to the bar
	bar.appendChild(div);

	// Add event listener to the checkbox
	checkbox.addEventListener('change', function() {
    	if (!this.checked) {
        	e.music.Volume = 0;  // Set the initial volume of the music player to 0
    	}
	});

	let trackIndices;
	let shuffledIndices;

 $("#game_start").click((event) => {
	event.preventDefault();
	musicMode()
  	})
	musicMode = () => {
    	$("#music_player")[0].children[0].style.display = "none"
    	$("#music_player")[0].children[1].style.display = "none"
    	document.getElementById("modLoadReveal").style.display = "none"
    	document.getElementById("modloaddiv").style.display = "none"
    	musicBox = document.getElementById("music_player")
    	musicBox.style.display = ""
    	var trackSel;
    	e = campaignTrail_temp
    	e.selectedSoundtrack = 0
    	toTime = (seconds) => {
        	var date = new Date(null);
        	date.setSeconds(seconds);
        	return date.toISOString().substr(11, 8);
    	}
    	generateTime = () => {
        	// Get the audio element
        	var audio = document.getElementById("campaigntrailmusic");
        	timeTracker = document.createElement("div");
        	timeTracker.id ='timeTracker'
        	timeTracker.style = `
  	text-align:left;
  	border-style:solid;
  	border-width:3px;
    border-color:white;
  	height:200px;
  	width:200px;
  	background-color:#AD8B55;
  	float:right;
  	padding: 10px;
  	`
        	$("#trackSelParent")[0].prepend(timeTracker);
        	$("#trackSelParent")[0].prepend(document.createElement("br"));
        	var positionDisplay = document.createElement("gg");
        	positionDisplay.id = "position-display";
        	var timeSlider = document.createElement("input");
        	timeSlider.type = "range";
        	timeSlider.min = 0;
        	timeSlider.max = 1;
        	timeSlider.step = 0.001;
        	timeSlider.value = 0;
        	timeSlider.style.width = "200px";
        	timeSlider.id = "time-slider";
        	var pausePlay = document.createElement("button");
        	pausePlay.id = "position-display";
        	pausePlay.innerHTML = "Pause"
        	pausePlay.style.width = "100%";
        	pausePlay.style.margin = "2px";
        	pausePlay.addEventListener("click", event => {
            	event.preventDefault();
            	updatePositionDisplay();
            	let audio = document.getElementById("campaigntrailmusic");
            	if (audio.paused) {
                	audio.play();
                	event.target.innerHTML = "Pause";
                	return;
            	}
            	audio.pause();
            	event.target.innerHTML = "Play";
            	return;
        	})
        	var shuffleButton = document.createElement("button");
        	shuffleButton.id = "shuffle-button";
        	shuffleButton.innerHTML = "Shuffle"
        	shuffleButton.style.width = "100%"
        	shuffleButton.style.margin = "2px";;
        	shuffleButton.addEventListener("click", event => {
            	event.preventDefault();
            	e.music.shuffleEnabled = !e.music.shuffleEnabled;
            	event.target.innerHTML = e.music.shuffleEnabled ? "Unshuffle" : "Shuffle";
            	if (e.music.shuffleEnabled) {
                	shuffledIndices = shuffle(trackIndices.slice());
                	let currentTrackIndex = Number(document.querySelector('input[name="trackSelector"]:checked').value);
                	shuffledIndices = shuffledIndices.filter(index => index !== currentTrackIndex);
                	shuffledIndices.unshift(currentTrackIndex);
            	}
        	});
        	var skipButton = document.createElement("button");
        	skipButton.id = "skip-button";
        	skipButton.innerHTML = "Skip"
        	skipButton.style.width = "100%";
        	skipButton.style.margin = "2px"; // Add margin
        	skipButton.addEventListener("click", event => {
            	event.preventDefault();
            	let selected = Number(document.querySelector('input[name="trackSelector"]:checked').value);
            	let newSel;
            	if (e.music.shuffleEnabled) {
                	if (!shuffledIndices) {
                    	shuffledIndices = shuffle(trackIndices.slice());
                	}
                	let currentIndex = shuffledIndices.findIndex(index => index === selected);
                	if (currentIndex === shuffledIndices.length - 1) {
                    	shuffledIndices = shuffle(trackIndices.slice());
                    	currentIndex = -1;
                	}
                	newSel = shuffledIndices[currentIndex + 1];
            	} else {
                	newSel = selected + 1 === soundtracks[e.selectedSoundtrack].tracklist.length ? 0 : selected + 1;
            	}
            	let buttons = Array.from(document.getElementById("trackSel").children).filter(f => {
                    	return f.tagName == "LABEL"
                	}).map(f => f.children[0])
            	buttons[newSel].click()
        	});
        	skipButton.style.width = "50%";
        	var loopButton = document.createElement("button");
        	loopButton.id = "loop-button";
        	loopButton.innerHTML = e.music.loopEnabled ? "Unloop" : "Loop Song";  // Check the initial loop state
        	loopButton.style.width = "50%";  // Match the width with skipButton
        	loopButton.style.margin = "2px";
        	loopButton.addEventListener("click", event => {
            	event.preventDefault();
            	e.music.loopEnabled = !e.music.loopEnabled;
            	let audio = document.getElementById("campaigntrailmusic");
            	audio.loop = e.music.loopEnabled;  // Set the audio's loop property
            	event.target.innerHTML = e.music.loopEnabled ? "Unloop" : "Loop Song";  // Toggle the button text
        	});
        	var volumeLabel = document.createElement("gg");
        	volumeLabel.id = "volume-label";
        	volumeLabel.innerHTML = "<br>Volume: "
        	var volumeSlider = document.createElement("input");
        	volumeSlider.type = "range";
        	volumeSlider.min = 0;
        	volumeSlider.max = 1;
        	volumeSlider.step = 0.001;
        	volumeSlider.value = 0;
        	volumeSlider.style.width = "200px";
        	volumeSlider.id = "volume-slider";
        	audio.volume= e.music.Volume;
        	volumeSlider.value = audio.volume;
        	timeTracker.appendChild(pausePlay);
        	if (audio.volume === 0) {
            	audio.pause();
            	pausePlay.innerHTML = "Play";  // Update the pause button text to "Play"
        	}
        	timeTracker.appendChild(shuffleButton);
        	var buttonContainer = document.createElement("div");
        	buttonContainer.style.display = "flex"; // Makes children inline
        	buttonContainer.style.justifyContent = "space-between";
        	skipButton.style.flex = "1"; // Makes it take up equal space
        	skipButton.style.marginRight = "5px"; // Adds some space between the buttons

        	loopButton.style.marginRight = "0px";

        	buttonContainer.appendChild(skipButton);
        	buttonContainer.appendChild(loopButton);

        	timeTracker.appendChild(buttonContainer); // Add the container to timeTracker instead of individual buttons
        	timeTracker.appendChild(positionDisplay);
        	timeTracker.appendChild(timeSlider);
        	timeTracker.appendChild(volumeLabel);
        	timeTracker.appendChild(volumeSlider);
        	updatePositionDisplay();
        	function updatePositionDisplay() {
            	positionDisplay.innerHTML = "Time: " + toTime(audio.currentTime) + "<br>";
            	timeSlider.value = audio.duration ? audio.currentTime / audio.duration : 0;
        	}
        	function changeTime() {
            	positionDisplay.innerHTML = "Time: " + toTime(audio.currentTime) + "<br>";
            	audio.currentTime = timeSlider.value * audio.duration;
        	}
        	updateVolume = event => {
            	audio.volume = event.target.value;
            	e.music.Volume=audio.volume;
        	}
        	setInterval(updatePositionDisplay, 1000);
        	timeSlider.addEventListener("input", changeTime);
        	volumeSlider.addEventListener("input", updateVolume)
    	}

	function newMusicPlayer(previousBgImage = null) {
        	trackSel = document.createElement("div");
        	trackSel.id = "trackSelParent";
        	let z = `<br><br><br><br><br><br><br><br><br><br><br><br><div id='trackSel' style="text-align:left;border-style:solid;border-width:3px;border-color:white;overflow-y: scroll;overflow-x: hidden;height:200px; width:400px;background-color:#AD8B55;float:right;">`
        	z += `<b><select id='selectSoundtrack'><option value='` + soundtracks[e.selectedSoundtrack].name + `'>` + soundtracks[e.selectedSoundtrack].name + "</option>"
        	for (i in soundtracks) {
            	if (soundtracks[e.selectedSoundtrack] != soundtracks[i]) {
                	z += `<option value='` + soundtracks[i].name + `'>` + soundtracks[i].name + `</option>`
            	}
        	}
        	z += `</select></b><br><br>`
            	// <label><input type="radio" name="option" value="option1">Option 1</label><br>
        	for (i in soundtracks[e.selectedSoundtrack].tracklist) {
            	let a = soundtracks[e.selectedSoundtrack].tracklist[i]
            	let b = `<label><input class="trackSelector" type="radio" name="trackSelector" value="` + i + `">` + a.name + `</label><br>`
            	z += b
        	}
        	z += "</div><br><br>"
        	trackSel.innerHTML = z
        	musicBox.appendChild(trackSel);
        	Array.from(document.getElementById("trackSel").children).filter(f => {
            	return f.tagName == "LABEL"
        	}).map(f => f.children[0])[0].checked = true
        	soundtrackSelector = document.getElementById("selectSoundtrack")
        	soundtrackSelector.onchange = function() {
            	let currentBgImage = document.getElementById("trackSel").style.backgroundImage;

            	for (i in soundtracks) {
                	if (soundtracks[i].name == soundtrackSelector.value) {
                    	e.selectedSoundtrack = i;
                    	break;
                	}
            	}
            	e.music.shuffleEnabled = false;
            	shuffledIndices = null;

            	document.getElementById("trackSelParent").remove();
            	newMusicPlayer(currentBgImage);  // Pass the current background image to the next function invocation.
        	};
        	var matches = document.querySelectorAll('.trackSelector');
        	for (match in matches) {
            	matches[match].onchange = function() {
                	audio = $("#campaigntrailmusic")[0];
                	audio.src = soundtracks[e.selectedSoundtrack].tracklist[this.value].url
                	audio.currentTime = 0
            	}
        	}
        	musicBox.children[2].loop = false
        	musicBox.children[2].src = soundtracks[e.selectedSoundtrack].tracklist[0].url

        	trackIndices = Array.from({length: soundtracks[e.selectedSoundtrack].tracklist.length}, (_, i) => i);

        	musicBox.children[2].onended = function() {
            	if (e.music.loopEnabled) {
                	this.play();  // If loop is enabled, simply play the same track again
            	} else {
            	let selected = Number(document.querySelector('input[name="trackSelector"]:checked').value);
            	let newSel;
            	if (e.music.shuffleEnabled) {
                	if (!shuffledIndices) {
                    	shuffledIndices = shuffle(trackIndices.slice());
                	}
                	let currentIndex = shuffledIndices.findIndex(index => index === selected);
                	if (currentIndex === shuffledIndices.length - 1) {
                    	shuffledIndices = shuffle(trackIndices.slice());
                    	currentIndex = -1;
                	}
                	newSel = shuffledIndices[currentIndex + 1];
            	} else {
                	newSel = selected + 1 === soundtracks[e.selectedSoundtrack].tracklist.length ? 0 : selected + 1;
            	}
            	let buttons = Array.from(document.getElementById("trackSel").children).filter(f => {
                    	return f.tagName == "LABEL"
                	}).map(f => f.children[0])
            	buttons[newSel].click()
            	}
        	}

        	for (w = 0; w < 7; w++) {
          	document.getElementById("trackSelParent").appendChild(document.createElement("br"))
        	}
        	generateTime();
       	if (previousBgImage) {
            	document.getElementById("trackSel").style.backgroundImage = previousBgImage;
             	document.getElementById("timeTracker").style.backgroundImage = previousBgImage;
        	}
    	}
    	clamp = function(a, max, min, overflow = true) {
        	if (overflow) {
            	return a > max ? min : a < min ? max : a;
        	}
        	return a > max ? max : a < min ? min : a;
    	}
    	var soundtracks = {
  0: {
    
          name: "Patriotic Songs",
          tracklist: [
            {
              "name": "The Star Spangled Banner",
              "url": "https://audio.jukehost.co.uk/5I84JGBliPJxR2rKIfU9lW1Dch2gj0lj"
            },
            {
              "name": "Yankee Doodle",
              "url": "https://audio.jukehost.co.uk/iQlgYWMKIBvm2ejHRHW3Q5MSa0k5wY9U"
            },
            {
              "name": "Free America",
              "url": "https://audio.jukehost.co.uk/uCNcnEBJArTvkJrEZowAnuuitCXqXizq"
            },
            {
              "name": "",
              "url": "https://audio.jukehost.co.uk/xWyGmn2j6NfvpYrvScZPLGALN6"
            },
            {
              "name": "",
              "url": "https://audio.jukehost.co.uk/hgpeWDLhU0QzWW0fGKIyXl3Z"
            },
            {
              "name": "",
              "url": "https://audio.jukehost.co.uk/Z6hNkFeEk2GFzdUBTAa46vfO"
            },
            {
              "name": "",
              "url": "https://audio.jukehost.co.uV9iVb6ZjYfvNeNW8ShcRmqIJ"
            },
            {
              "name": "",
              "url": ""
	},
	],
  },


  2: {
	name: "Special",
	tracklist: [
	{
    	name: "placeholder 1",
    	url: "https://raw.githubusercontent.com/Diamondy30901/Diamondy-Mods/main/media%20backup/12AM_Animal_Crossing_New_Leaf_OST_Official_Soundtrack_Nintendo_3DS.mp3",
	},
	{
    	name: "placeholder 2",
    	url: "https://raw.githubusercontent.com/Diamondy30901/Diamondy-Mods/main/media%20backup/11PM%20 Animal Crossing New Leaf%20 Unextended.mp3",
	},
	],
  },
}

    	newMusicPlayer()
  	}

      	function shuffle(array) {
        	let currentIndex = array.length, temporaryValue, randomIndex;

        	while (0 !== currentIndex) {
            	randomIndex = Math.floor(Math.random() * currentIndex);
            	currentIndex -= 1;

            	temporaryValue = array[currentIndex];
            	array[currentIndex] = array[randomIndex];
            	array[randomIndex] = temporaryValue;
        	}

        	return array;
    	}
}


quotes = ["'Knowledge is ecstatic in enjoyment, perennial in frame, unlimited in space and indefinite in duration.' - DeWitt Clinton", "'If men were angels, no government would be necessary.' - James Madison", "'We lack many things, but we possess the most precious of all, liberty.' - James Monroe", "'The Constitution is the guide which I never will abandon.' - George Washington", "'When angry, count ten before you speak.' - Thomas Jefferson"]
customquote = quotes[Math.floor((Math.random() * quotes.length))]
            
corrr = `
<div style="background:linear-gradient(to bottom,#5b462c,#a68a64); color:white;">
  <h2>CAMPAIGN TRAIL SHOWCASE</h2>
  <font id="wittyquote" size="3" color="white"><em>${customquote}</em></font>
</div>
`;

function appendStyle() {
    if (!document.querySelector('meta[name="viewport"]')) {
        const metaTag = document.createElement('meta');
        metaTag.name = "viewport";
        metaTag.content = "width=device-width, initial-scale=1";
        document.head.appendChild(metaTag);
    }

    if (!document.querySelector('#radio-option-style')) {
        const style = document.createElement('style');
        style.id = 'radio-option-style';
        style.textContent = `
          body {
               background-image: url(https://i.imgur.com/tg28aiA.jpeg);
               background-position: center;
               background-size: cover;
          }
        `;
        document.head.appendChild(style);
    }
}

appendStyle();

            
nct_stuff.themes[nct_stuff.selectedTheme].coloring_title = "#A58963";

nct_stuff.themes[nct_stuff.selectedTheme].coloring_window = "#004f80";

document.getElementsByClassName("game_header")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_title;

$("#game_window")[0].style.backgroundColor = nct_stuff.themes[nct_stuff.selectedTheme].coloring_window;

$(".container")[0].style.backgroundColor = "#0085c7";

document.getElementById("header").src = "https://i.imgur.com/ly60Au8.png";

document.body.background = "https://i.imgur.com/C6ihfIH.jpeg";

document.head.innerHTML += '<style>#results_container {color:#ffff;} .inner_window_w_desc {background:linear-gradient(to bottom,#5b462c,#a68a64)!important;border:1px solid #3b2a16;box-shadow:inset 0 0 10px rgba(0,0,0,0.25);color:#000000;}</style>';

//#endcode
